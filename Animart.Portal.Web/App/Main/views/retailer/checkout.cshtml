<ngcart-cart></ngcart-cart>
<script type="text/ng-template" id="template/ngCart/cart.html">
    <div class="alert alert-warning" role="alert" ng-show="ngCart.getTotalItems() === 0">
        Your cart is empty
    </div>
    <div class="table-responsive col-lg-12" ng-show="ngCart.getTotalItems() > 0" ng-controller="app.views.retailer.checkout">
        <label>Review Order</label>
        <table class="table table-striped ngCart cart table-bordered">
            <thead>
                <tr>
                    <th></th>
                    <th>Name</th>
                    <th>Is Pre-Order</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                </tr>     
            </thead>         
            <tbody>
                <tr ng-repeat="item in ngCart.getCart().items track by $index">
                    <td><span ng-click="ngCart.removeItemById(item.getId())" class="glyphicon glyphicon-remove"></span></td>
                    <td>{{ item.getName() }}</td>
                    <td>{{ item.getData().ispo }}</td>
                    <td>{{ item.getPrice() | currency:"Rp."}}</td>
                    <td>
                        <span class="fa fa-minus-circle" ng-class="{'disabled':item.getQuantity()<=1}"
                                ng-click="item.setQuantity(-1, true)"></span>&nbsp;&nbsp;
                        {{ item.getQuantity() | number }}&nbsp;&nbsp;
                        <span class="fa fa-plus-circle" ng-class="{'disabled':item.getQuantity()>=item.getData().inStock && !item.getData().ispo ||(item.getData().ispo && item.getQuantity()>=100)}"
                              ng-click="item.setQuantity(1, true)"></span>
                    </td>
                    <td>{{ item.getQuantity() *  item.getPrice() | currency:"Rp." }}</td>
                </tr>
            </tbody>     
            <tfoot>
                <tr>
                    <td colspan="5" align="right" width="70%"><strong>Weight ({{po.totalGram}} gr):</strong></td>
                    <td>{{ po.totalWeight}} kg</td>
                </tr>
                <tr>
                    <td colspan="5" align="right"><strong>SubTotal:</strong></td>
                    <td><strong>{{ po.subTotal | currency:"Rp." }}</strong></td>
                </tr>
            </tfoot>
            </table>
          
            <label>Shipping Address and Expedition Information</label>
            <label style="color:red;">*Please fill your shipping address information</label>
            <table class="table table-striped ngCart cart table-bordered">
                <tbody>
                    <tr>
                        <td colspan="5">
                            <div>
                                <md-input-container class="md-block">
                                </md-input-container>
                                <md-input-container class="md-block">
                                    <label><strong>Address</strong></label>
                                    <input ng-model="po.address">
                                </md-input-container>
                                <div layout-gt-sm="row">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label><strong>Province</strong></label>
                                        <input ng-model="po.province">
                                    </md-input-container>
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label><strong>City</strong></label>
                                        <md-select ng-model="po.city"  ng-change="updateExpedition()">
                                            <md-option ng-repeat="city in cities">
                                                {{city.name}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label><strong>Postal Code</strong></label>
                                        <input name="postalCode" ng-model="po.postalCode" placeholder="12345"
                                               required ng-pattern="/^[0-9]{5}$/" md-maxlength="5">
                                        <div ng-messages="poForm.postalCode.$error" role="alert" multiple>
                                            <div ng-message="required" class="my-message">You must supply a postal code.</div>
                                            <div ng-message="pattern" class="my-message">
                                                That doesn't look like a valid postal
                                                code.
                                            </div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout-gt-sm="row" ng-hide="po.showExpedition">
                                   <label style="color:red;">*Please select your city first, to choose an expedition</label>
                                </div>
                                <div layout-gt-sm="row" ng-show="po.showExpedition">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label><strong>Expedition</strong></label>
                                        <md-select ng-model="po.expedition" ng-change="updateShippingPrice()">
                                            <md-option ng-repeat="expedition in expeditions">
                                                {{expedition.expedition}}-{{expedition.type}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="4" align="right" width="70%"><strong>Shipping per(kg):</strong></td>
                        <td>{{ po.shipping | currency:"Rp." }}</td>
                    </tr>
                    <tr>
                        <td colspan="4" align="right"><strong>Weight ({{po.totalGram}} gr):</strong></td>
                        <td>{{ po.totalWeight }} kg</td>
                    </tr>
                    <tr>
                        <td colspan="4" align="right"><strong>Total Shipping:</strong></td>
                        <td><strong>{{ ngCart.getShipping() | currency:"Rp." }}</strong></td>
                    </tr>
                </tfoot>
            </table>
            <label>Total Payment</label>
            <table class="table table-striped ngCart cart table-bordered">
                @*<tr ng-show="ngCart.getTax()">
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>Tax ({{ ngCart.getTaxRate() }}%):</td>
                    <td>{{ ngCart.getTax() | currency:"Rp." }}</td>
                </tr>*@
                <tr>
                    <td colspan="4" align="right" width="70%"><strong>Item(s) SubTotal:</strong></td>
                    <td>{{ po.subTotal | currency:"Rp." }}</td>
                </tr>
                <tr>
                    <td colspan="4" align="right"><strong>Total Shipping:</strong></td>
                    <td>{{ ngCart.getShipping() | currency:"Rp. "}}</td>
                </tr>
                <tr>
                    <td colspan="4" align="right"><strong>Total:</strong></td>
                    <td><strong>{{ ngCart.totalCost() | currency:"Rp." }}</strong></td>
                </tr>           
            </table>   
        <div class="col-lg-12" style="text-align:right;">
            <label style="color:red;" ng-show="isCombined">CANNOT PURCHASE PRE-ORDER AND READY STOCK ITEM TOGETHER, PLEASE REMOVE SOME ITEMS FROM YOUR CART</label>
            <a href="" class="btn btn-primary" ng-hide="po.hideOrderBtn || isCombined" ng-click="placeOrder()">Order Now</a>
            <a href="./#/hwto"><h2><u>How to Pay</u></h2></a>
        </div>    
    </div>
   
</script>